<!DOCTYPE html>
<html lang="pt-BR">
  

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Banco Imobiliário Digital</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <div id="qr-codes" class="flex justify-center space-x-4 mb-8">
      <!-- QR Codes serão gerados dinamicamente aqui -->
  </div>
  <script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>
<script>
    const gameId = "xyz"; // ID único da partida
    const serverUrl = "wss://meujogo.com/ws"; // URL do servidor WebSocket
    const qrCodesContainer = document.getElementById("qr-codes");

    // Inicializar WebSocket
    const socket = new WebSocket(serverUrl);

    socket.onopen = () => {
        console.log("Conectado ao servidor WebSocket.");
    };

    socket.onmessage = (event) => {
        const data = JSON.parse(event.data);
        if (data.type === "update") {
            // Atualizar informações do jogador
            updatePlayerInfoFromServer(data.payload);
        }
    };

    socket.onerror = (error) => {
        console.error("Erro no WebSocket:", error);

    };

    // Gerar QR Codes para cada jogador
    function generateQRCodes() {
        gameState.players.forEach(player => {
            const qrCodeDiv = document.createElement("div");
            qrCodeDiv.className = "text-center";

            const qrCodeCanvas = document.createElement("canvas");
            qrCodeDiv.appendChild(qrCodeCanvas);

            const playerLink = `https://meujogo.com/partida/${gameId}/jogador${player.id}`;
            QRCode.toCanvas(qrCodeCanvas, playerLink, { width: 128 }, (error) => {
                if (error) console.error("Erro ao gerar QR Code:", error);
            });

            const playerLabel = document.createElement("p");
            playerLabel.textContent = player.name;
            playerLabel.className = "text-sm font-bold mt-2";
            qrCodeDiv.appendChild(playerLabel);

            qrCodesContainer.appendChild(qrCodeDiv);
        });
    }const gameState = {
        players: [
            { id: 1, name: "Jogador 1", balance: 1500, position: 0, color: "red", properties: [], inJail: false },
            { id: 2, name: "Jogador 2", balance: 1500, position: 0, color: "blue", properties: [], inJail: false },
            { id: 3, name: "Jogador 3", balance: 1500, position: 0, color: "green", properties: [], inJail: false },
            { id: 4, name: "Jogador 4", balance: 1500, position: 0, color: "yellow", properties: [], inJail: false }
        ],
        currentPlayerIndex: 0,
        properties: [
            // ...existing properties...
        ],
        diceRolled: false
    };

    // Adicionar sistema de QR Code e WebSocket aqui
    const gameId = "xyz"; // ID único da partida
    const serverUrl = "wss://meujogo.com/ws"; // URL do servidor WebSocket
    const qrCodesContainer = document.getElementById("qr-codes");

    // Inicializar WebSocket
    const socket = new WebSocket(serverUrl);

    socket.onopen = () => {
        console.log("Conectado ao servidor WebSocket.");
    };

    socket.onmessage = (event) => {
        const data = JSON.parse(event.data);
        if (data.type === "update") {
            updatePlayerInfoFromServer(data.payload);
        }
    };

    socket.onerror = (error) => {
        console.error("Erro no WebSocket:", error);
    };

    // Gerar QR Codes para cada jogador
    function generateQRCodes() {
        gameState.players.forEach(player => {
            const qrCodeDiv = document.createElement("div");
            qrCodeDiv.className = "text-center";

            const qrCodeCanvas = document.createElement("canvas");
            qrCodeDiv.appendChild(qrCodeCanvas);

            const playerLink = `https://meujogo.com/partida/${gameId}/jogador${player.id}`;
            QRCode.toCanvas(qrCodeCanvas, playerLink, { width: 128 }, (error) => {
                if (error) console.error("Erro ao gerar QR Code:", error);
            });

            const playerLabel = document.createElement("p");
            playerLabel.textContent = player.name;
            playerLabel.className = "text-sm font-bold mt-2";
            qrCodeDiv.appendChild(playerLabel);

            qrCodesContainer.appendChild(qrCodeDiv);
        });
    }

    // Enviar atualizações para o servidor
    function sendUpdateToServer(type, payload) {
        socket.send(JSON.stringify({ type, payload }));
    }

    // Atualizar informações do jogador a partir do servidor
    function updatePlayerInfoFromServer(payload) {
        const player = gameState.players.find(p => p.id === payload.playerId);
        if (player) {
            player.balance = payload.balance;
            player.properties = payload.properties;
            updatePlayerInfo();
        }
    }

    // Chamar a função para gerar os QR Codes
    generateQRCodes();

    // Enviar atualizações para o servidor
    function sendUpdateToServer(type, payload) {
        socket.send(JSON.stringify({ type, payload }));
    }

    // Atualizar informações do jogador a partir do servidor
    function updatePlayerInfoFromServer(payload) {
        const player = gameState.players.find(p => p.id === payload.playerId);
        if (player) {
            player.balance = payload.balance;
            player.properties = payload.properties;
            updatePlayerInfo();
        }
    }

    // Chamar a função para gerar os QR Codes
    generateQRCodes();
    function buyProperty(property) {
    const player = gameState.players[gameState.currentPlayerIndex];
    
    player.balance -= property.price;
    property.owner = player.id;
    player.properties.push(property.id);
    
    updatePlayerInfo();
    addToGameLog(`${player.name} comprou ${property.name} por $${property.price}.`);
    
    // Enviar atualização para o servidor
    sendUpdateToServer("propertyPurchase", {
        playerId: player.id,
        propertyId: property.id,
        balance: player.balance,
        properties: player.properties
    });
}
</script>
    <style>
        .board {
            display: grid;
            grid-template-columns: repeat(11, 1fr);
            grid-template-rows: repeat(11, 1fr);
            width: 800px;
            height: 800px;
            margin: 0 auto;
            position: relative;
            background-color: #f5f5dc;
            border-radius: 8px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }
        
        .property {
            border: 1px solid #8B4513;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 5px;
            font-size: 12px;
            text-align: center;
            position: relative;
            transition: all 0.3s ease;
        }
        
        .property:hover {
            transform: scale(1.05);
            z-index: 20;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
        }
        
        .corner {
            background-color: #f0e6cc;
            font-weight: bold;
        }
        
        .player-token {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            position: absolute;
            top: 5px;
            left: 5px;
            z-index: 10;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
            transition: all 0.5s ease;
        }
        
        .property-group-1 { background-color: #a7d8ff; }
        .property-group-2 { background-color: #ffb6c1; }
        .property-group-3 { background-color: #98fb98; }
        .property-group-4 { background-color: #ffd700; }
        .property-group-5 { background-color: #ff6347; }
        .property-group-6 { background-color: #9370db; }
        .property-group-7 { background-color: #ffa500; }
        .property-group-8 { background-color: #ff0000; }
        
        .modal {
            display: none;
            position: fixed;
            z-index: 100;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.7);
            backdrop-filter: blur(5px);
        }
        
        .modal-content {
            background-color: white;
            margin: 15% auto;
            padding: 25px;
            border-radius: 12px;
            width: 50%;
            max-width: 500px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            animation: modalFadeIn 0.4s;
        }
        
        @keyframes modalFadeIn {
            from { opacity: 0; transform: translateY(-50px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .dice-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 120px;
            height: 120px;
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            z-index: 5;
        }
        
        .dice {
            font-size: 40px;
            text-align: center;
            margin: 10px 0;
            display: flex;
            gap: 10px;
        }
        
        .property-houses {
            position: absolute;
            bottom: 5px;
            display: flex;
            gap: 2px;
        }
        
        .house {
            width: 8px;
            height: 8px;
            background-color: green;
            border-radius: 2px;
        }
        
        .hotel {
            width: 10px;
            height: 10px;
            background-color: red;
            border-radius: 50%;
        }
        
        .dice-btn {
            background: linear-gradient(145deg, #4a6bff, #3a56d4);
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            transition: all 0.3s;
        }
        
        .dice-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
        }
        
        .dice-btn:active {
            transform: translateY(1px);
        }
        
        .dice-value {
            font-size: 24px;
            font-weight: bold;
            color: #333;
            margin-top: 5px;
        }
        
        .center-logo {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 150px;
            height: 150px;
            background-color: #fff;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.2);
            z-index: 1;
            border: 5px solid #8B4513;
        }
        
        .center-logo img {
            width: 80%;
            height: 80%;
            object-fit: contain;
        }
    </style>
</head>
<body class="bg-gray-100">
    <div class="container mx-auto py-8">
        <h1 class="text-4xl font-bold text-center mb-8 text-indigo-800">Banco Imobiliário Digital</h1>
        
        <div class="flex justify-center mb-8">
            <div class="bg-white p-6 rounded-lg shadow-lg w-full max-w-4xl">
                <div class="flex justify-between items-center mb-4">
                    <div>
                        <h2 class="text-xl font-semibold">Jogador Atual: <span id="current-player" class="font-bold"></span></h2>
                        <p class="text-gray-600">Saldo: $<span id="current-balance">0</span></p>
                    </div>
                    <div class="flex space-x-4">
                        <button id="roll-dice" class="bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 text-white px-6 py-3 rounded-full shadow-lg transition-all duration-300 transform hover:scale-105">
                            <i class="fas fa-dice mr-2"></i>Lançar Dados
                        </button>
                        <button id="end-turn" class="bg-gradient-to-r from-gray-500 to-gray-600 hover:from-gray-600 hover:to-gray-700 text-white px-6 py-3 rounded-full shadow-lg transition-all duration-300 transform hover:scale-105" disabled>
                            <i class="fas fa-flag-checkered mr-2"></i>Terminar Turno
                        </button>
                    </div>
                </div>
                
                <div class="grid grid-cols-4 gap-4 mb-6">
                    <div class="bg-red-100 p-4 rounded-lg border-l-4 border-red-500 shadow">
                        <h3 class="font-semibold text-red-800">Jogador 1</h3>
                        <p class="text-gray-700">Saldo: $<span id="balance-1" class="font-bold">1500</span></p>
                        <div class="mt-2 h-2 bg-red-200 rounded-full">
                            <div id="health-1" class="h-2 bg-red-500 rounded-full" style="width: 100%"></div>
                        </div>
                    </div>
                    <div class="bg-blue-100 p-4 rounded-lg border-l-4 border-blue-500 shadow">
                        <h3 class="font-semibold text-blue-800">Jogador 2</h3>
                        <p class="text-gray-700">Saldo: $<span id="balance-2" class="font-bold">1500</span></p>
                        <div class="mt-2 h-2 bg-blue-200 rounded-full">
                            <div id="health-2" class="h-2 bg-blue-500 rounded-full" style="width: 100%"></div>
                        </div>
                    </div>
                    <div class="bg-green-100 p-4 rounded-lg border-l-4 border-green-500 shadow">
                        <h3 class="font-semibold text-green-800">Jogador 3</h3>
                        <p class="text-gray-700">Saldo: $<span id="balance-3" class="font-bold">1500</span></p>
                        <div class="mt-2 h-2 bg-green-200 rounded-full">
                            <div id="health-3" class="h-2 bg-green-500 rounded-full" style="width: 100%"></div>
                        </div>
                    </div>
                    <div class="bg-yellow-100 p-4 rounded-lg border-l-4 border-yellow-500 shadow">
                        <h3 class="font-semibold text-yellow-800">Jogador 4</h3>
                        <p class="text-gray-700">Saldo: $<span id="balance-4" class="font-bold">1500</span></p>
                        <div class="mt-2 h-2 bg-yellow-200 rounded-full">
                            <div id="health-4" class="h-2 bg-yellow-500 rounded-full" style="width: 100%"></div>
                        </div>
                    </div>
                </div>
                
                <div class="bg-white p-4 rounded-lg border border-gray-200 shadow-inner">
                    <h3 class="font-semibold mb-2 text-gray-700">Histórico do Jogo</h3>
                    <div id="game-log" class="h-32 overflow-y-auto border border-gray-200 p-3 text-sm bg-gray-50 rounded"></div>
                </div>
            </div>
        </div>
        
        <div class="relative">
            <div class="board bg-white shadow-lg">
                <!-- Corner: Partida -->
                <div class="property corner" style="grid-column: 1 / span 2; grid-row: 1 / span 2;">
                    <i class="fas fa-flag text-3xl mb-1 text-green-600"></i>
                    <span class="font-bold">PARTIDA</span>
                    <div class="absolute bottom-2 right-2 text-xs font-bold">$200</div>
                </div>
                
                <!-- Top Row -->
                <div class="property property-group-1" style="grid-column: 3; grid-row: 1;">
                    <span class="font-medium">Leblon</span>
                    <div class="text-xs font-bold">$100</div>
                    <div class="property-houses"></div>
                </div>
                <div class="property property-group-1" style="grid-column: 4; grid-row: 1;">
                    <span class="font-medium">Av. Vieira Souto</span>
                    <div class="text-xs font-bold">$100</div>
                    <div class="property-houses"></div>
                </div>
                <div class="property" style="grid-column: 5; grid-row: 1; background-color: #ffcccb;">
                    <i class="fas fa-question text-2xl mb-1 text-red-600"></i>
                    <span class="font-medium">Sorte/Reves</span>
                </div>
                <div class="property property-group-2" style="grid-column: 6; grid-row: 1;">
                    <span class="font-medium">Av. N.S. Copacabana</span>
                    <div class="text-xs font-bold">$120</div>
                    <div class="property-houses"></div>
                </div>
                <div class="property" style="grid-column: 7; grid-row: 1; background-color: #e6e6fa;">
                    <i class="fas fa-train text-2xl mb-1 text-purple-800"></i>
                    <span class="font-medium">Estação</span>
                    <div class="text-xs font-bold">$200</div>
                </div>
                <div class="property property-group-2" style="grid-column: 8; grid-row: 1;">
                    <span class="font-medium">Av. Presidente Vargas</span>
                    <div class="text-xs font-bold">$140</div>
                    <div class="property-houses"></div>
                </div>
                <div class="property property-group-2" style="grid-column: 9; grid-row: 1;">
                    <span class="font-medium">Av. Rio Branco</span>
                    <div class="text-xs font-bold">$160</div>
                    <div class="property-houses"></div>
                </div>
                <div class="property property-group-3" style="grid-column: 10; grid-row: 1;">
                    <span class="font-medium">Interlagos</span>
                    <div class="text-xs font-bold">$180</div>
                    <div class="property-houses"></div>
                </div>
                
                <!-- Corner: Prisão -->
                <div class="property corner" style="grid-column: 11 / span 2; grid-row: 1 / span 2;">
                    <i class="fas fa-lock text-3xl mb-1 text-red-600"></i>
                    <span class="font-bold">PRISÃO</span>
                </div>
                
                <!-- Right Column -->
                <div class="property property-group-3" style="grid-column: 11; grid-row: 3;">
                    <span class="font-medium">Morumbi</span>
                    <div class="text-xs font-bold">$180</div>
                    <div class="property-houses"></div>
                </div>
                <div class="property" style="grid-column: 11; grid-row: 4; background-color: #e6f7ff;">
                    <i class="fas fa-lightbulb text-2xl mb-1 text-blue-600"></i>
                    <span class="font-medium">Companhia</span>
                    <div class="text-xs font-bold">$150</div>
                </div>
                <div class="property property-group-3" style="grid-column: 11; grid-row: 5;">
                    <span class="font-medium">Flamengo</span>
                    <div class="text-xs font-bold">$200</div>
                    <div class="property-houses"></div>
                </div>
                <div class="property property-group-4" style="grid-column: 11; grid-row: 6;">
                    <span class="font-medium">Botafogo</span>
                    <div class="text-xs font-bold">$220</div>
                    <div class="property-houses"></div>
                </div>
                <div class="property" style="grid-column: 11; grid-row: 7; background-color: #e6e6fa;">
                    <i class="fas fa-train text-2xl mb-1 text-purple-800"></i>
                    <span class="font-medium">Estação</span>
                    <div class="text-xs font-bold">$200</div>
                </div>
                <div class="property property-group-4" style="grid-column: 11; grid-row: 8;">
                    <span class="font-medium">Av. Brasil</span>
                    <div class="text-xs font-bold">$240</div>
                    <div class="property-houses"></div>
                </div>
                <div class="property property-group-4" style="grid-column: 11; grid-row: 9;">
                    <span class="font-medium">Av. Paulista</span>
                    <div class="text-xs font-bold">$260</div>
                    <div class="property-houses"></div>
                </div>
                
                <!-- Corner: Parada Livre -->
                <div class="property corner" style="grid-column: 11 / span 2; grid-row: 11 / span 2;">
                    <i class="fas fa-parking text-3xl mb-1 text-green-600"></i>
                    <span class="font-bold">PARADA LIVRE</span>
                </div>
                
                <!-- Bottom Row -->
                <div class="property property-group-5" style="grid-column: 10; grid-row: 11;">
                    <span class="font-medium">Jardim Europa</span>
                    <div class="text-xs font-bold">$280</div>
                    <div class="property-houses"></div>
                </div>
                <div class="property" style="grid-column: 9; grid-row: 11; background-color: #ffcccb;">
                    <i class="fas fa-question text-2xl mb-1 text-red-600"></i>
                    <span class="font-medium">Sorte/Reves</span>
                </div>
                <div class="property property-group-5" style="grid-column: 8; grid-row: 11;">
                    <span class="font-medium">Copacabana</span>
                    <div class="text-xs font-bold">$300</div>
                    <div class="property-houses"></div>
                </div>
                <div class="property property-group-5" style="grid-column: 7; grid-row: 11;">
                    <span class="font-medium">Av. Atlântica</span>
                    <div class="text-xs font-bold">$320</div>
                    <div class="property-houses"></div>
                </div>
                <div class="property" style="grid-column: 6; grid-row: 11; background-color: #e6e6fa;">
                    <i class="fas fa-train text-2xl mb-1 text-purple-800"></i>
                    <span class="font-medium">Estação</span>
                    <div class="text-xs font-bold">$200</div>
                </div>
                <div class="property property-group-6" style="grid-column: 5; grid-row: 11;">
                    <span class="font-medium">Ipanema</span>
                    <div class="text-xs font-bold">$350</div>
                    <div class="property-houses"></div>
                </div>
                <div class="property" style="grid-column: 4; grid-row: 11; background-color: #ffeb99;">
                    <i class="fas fa-gavel text-2xl mb-1 text-amber-800"></i>
                    <span class="font-medium">Imposto</span>
                    <div class="text-xs font-bold">$100</div>
                </div>
                <div class="property property-group-6" style="grid-column: 3; grid-row: 11;">
                    <span class="font-medium">Leblon</span>
                    <div class="text-xs font-bold">$400</div>
                    <div class="property-houses"></div>
                </div>
                
                <!-- Left Column -->
                <div class="property property-group-7" style="grid-column: 1; grid-row: 9;">
                    <span class="font-medium">Av. Brigadeiro Faria Lima</span>
                    <div class="text-xs font-bold">$350</div>
                    <div class="property-houses"></div>
                </div>
                <div class="property property-group-7" style="grid-column: 1; grid-row: 8;">
                    <span class="font-medium">Av. Rebouças</span>
                    <div class="text-xs font-bold">$320</div>
                    <div class="property-houses"></div>
                </div>
                <div class="property" style="grid-column: 1; grid-row: 7; background-color: #e6e6fa;">
                    <i class="fas fa-train text-2xl mb-1 text-purple-800"></i>
                    <span class="font-medium">Estação</span>
                    <div class="text-xs font-bold">$200</div>
                </div>
                <div class="property property-group-7" style="grid-column: 1; grid-row: 6;">
                    <span class="font-medium">Av. 9 de Julho</span>
                    <div class="text-xs font-bold">$300</div>
                    <div class="property-houses"></div>
                </div>
                <div class="property" style="grid-column: 1; grid-row: 5; background-color: #e6f7ff;">
                    <i class="fas fa-lightbulb text-2xl mb-1 text-blue-600"></i>
                    <span class="font-medium">Companhia</span>
                    <div class="text-xs font-bold">$150</div>
                </div>
                <div class="property property-group-8" style="grid-column: 1; grid-row: 4;">
                    <span class="font-medium">Av. Pacaembu</span>
                    <div class="text-xs font-bold">$280</div>
                    <div class="property-houses"></div>
                </div>
                <div class="property" style="grid-column: 1; grid-row: 3; background-color: #ffcccb;">
                    <i class="fas fa-question text-2xl mb-1 text-red-600"></i>
                    <span class="font-medium">Sorte/Reves</span>
                </div>
                
                <!-- Center Dice System -->
                <div class="dice-container">
                    <div class="dice" id="dice-display">
                        <i class="fas fa-dice"></i>
                        <i class="fas fa-dice"></i>
                    </div>
                    <div class="dice-value" id="dice-total-display">0</div>
                </div>
                
                <!-- Center Logo -->
                <div class="center-logo">
                    <div class="text-4xl font-bold text-indigo-800">MONOPOLY</div>
                </div>
                
                <!-- Player Tokens -->
                <div class="player-token bg-red-500" id="token-1"></div>
                <div class="player-token bg-blue-500" id="token-2"></div>
                <div class="player-token bg-green-500" id="token-3"></div>
                <div class="player-token bg-yellow-500" id="token-4"></div>
            </div>
        </div>
    </div>
    
    <!-- Modal for actions -->
    <div id="action-modal" class="modal">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold" id="modal-title">Ação</h3>
                <button id="close-modal" class="text-gray-500 hover:text-gray-700 text-xl">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div id="modal-body">
                <p id="modal-message" class="text-gray-700 mb-4"></p>
                <div id="modal-actions" class="mt-4 flex justify-center space-x-4">
                    <!-- Actions will be added here dynamically -->
                </div>
            </div>
        </div>
    </div>
    
    <!-- Dice Roll Modal -->
    <div id="dice-modal" class="modal">
        <div class="modal-content">
            <h3 class="text-xl font-bold mb-4 text-center">Lançando Dados...</h3>
            <div class="dice flex justify-center" id="dice-result">
                <i class="fas fa-dice fa-spin text-5xl"></i>
                <i class="fas fa-dice fa-spin text-5xl"></i>
            </div>
            <div class="text-center mt-4">
                <p id="dice-total" class="text-2xl font-bold text-indigo-700"></p>
            </div>
        </div>
    </div>
    
    <script>
        // Game state
        const gameState = {
            players: [
                { id: 1, name: "Jogador 1", balance: 1500, position: 0, color: "red", properties: [], inJail: false },
                { id: 2, name: "Jogador 2", balance: 1500, position: 0, color: "blue", properties: [], inJail: false },
                { id: 3, name: "Jogador 3", balance: 1500, position: 0, color: "green", properties: [], inJail: false },
                { id: 4, name: "Jogador 4", balance: 1500, position: 0, color: "yellow", properties: [], inJail: false }
            ],
            currentPlayerIndex: 0,
            properties: [
                { id: 0, name: "Partida", price: 0, group: "corner", type: "start" },
                { id: 1, name: "Leblon", price: 100, group: 1, rent: [6, 30, 90, 270, 400, 550], owner: null, houses: 0 },
                { id: 2, name: "Av. Vieira Souto", price: 100, group: 1, rent: [6, 30, 90, 270, 400, 550], owner: null, houses: 0 },
                { id: 3, name: "Sorte/Reves", price: 0, group: "chance", type: "chance" },
                { id: 4, name: "Av. N.S. Copacabana", price: 120, group: 2, rent: [8, 40, 100, 300, 450, 600], owner: null, houses: 0 },
                { id: 5, name: "Estação", price: 200, group: "railroad", rent: [25, 50, 100, 200], owner: null },
                { id: 6, name: "Av. Presidente Vargas", price: 140, group: 2, rent: [10, 50, 150, 450, 625, 750], owner: null, houses: 0 },
                { id: 7, name: "Av. Rio Branco", price: 160, group: 2, rent: [12, 60, 180, 500, 700, 900], owner: null, houses: 0 },
                { id: 8, name: "Interlagos", price: 180, group: 3, rent: [14, 70, 200, 550, 750, 950], owner: null, houses: 0 },
                { id: 9, name: "Prisão", price: 0, group: "corner", type: "jail" },
                { id: 10, name: "Morumbi", price: 180, group: 3, rent: [14, 70, 200, 550, 750, 950], owner: null, houses: 0 },
                { id: 11, name: "Companhia", price: 150, group: "utility", rent: [4, 10], owner: null },
                { id: 12, name: "Flamengo", price: 200, group: 3, rent: [16, 80, 220, 600, 800, 1000], owner: null, houses: 0 },
                { id: 13, name: "Botafogo", price: 220, group: 4, rent: [18, 90, 250, 700, 875, 1050], owner: null, houses: 0 },
                { id: 14, name: "Estação", price: 200, group: "railroad", rent: [25, 50, 100, 200], owner: null },
                { id: 15, name: "Av. Brasil", price: 240, group: 4, rent: [20, 100, 300, 750, 925, 1100], owner: null, houses: 0 },
                { id: 16, name: "Av. Paulista", price: 260, group: 4, rent: [22, 110, 330, 800, 975, 1150], owner: null, houses: 0 },
                { id: 17, name: "Parada Livre", price: 0, group: "corner", type: "free" },
                { id: 18, name: "Jardim Europa", price: 280, group: 5, rent: [24, 120, 360, 850, 1025, 1200], owner: null, houses: 0 },
                { id: 19, name: "Sorte/Reves", price: 0, group: "chance", type: "chance" },
                { id: 20, name: "Copacabana", price: 300, group: 5, rent: [26, 130, 390, 900, 1100, 1275], owner: null, houses: 0 },
                { id: 21, name: "Av. Atlântica", price: 320, group: 5, rent: [28, 150, 450, 1000, 1200, 1400], owner: null, houses: 0 },
                { id: 22, name: "Estação", price: 200, group: "railroad", rent: [25, 50, 100, 200], owner: null },
                { id: 23, name: "Ipanema", price: 350, group: 6, rent: [35, 175, 500, 1100, 1300, 1500], owner: null, houses: 0 },
                { id: 24, name: "Imposto", price: 0, group: "tax", type: "tax", amount: 100 },
                { id: 25, name: "Leblon", price: 400, group: 6, rent: [50, 200, 600, 1400, 1700, 2000], owner: null, houses: 0 },
                { id: 26, name: "Av. Brigadeiro Faria Lima", price: 350, group: 7, rent: [35, 175, 500, 1100, 1300, 1500], owner: null, houses: 0 },
                { id: 27, name: "Av. Rebouças", price: 320, group: 7, rent: [28, 150, 450, 1000, 1200, 1400], owner: null, houses: 0 },
                { id: 28, name: "Estação", price: 200, group: "railroad", rent: [25, 50, 100, 200], owner: null },
                { id: 29, name: "Av. 9 de Julho", price: 300, group: 7, rent: [26, 130, 390, 900, 1100, 1275], owner: null, houses: 0 },
                { id: 30, name: "Companhia", price: 150, group: "utility", rent: [4, 10], owner: null },
                { id: 31, name: "Av. Pacaembu", price: 280, group: 8, rent: [24, 120, 360, 850, 1025, 1200], owner: null, houses: 0 },
                { id: 32, name: "Sorte/Reves", price: 0, group: "chance", type: "chance" }
            ],
            diceRolled: false
        };
        
        // DOM elements
        const currentPlayerEl = document.getElementById('current-player');
        const currentBalanceEl = document.getElementById('current-balance');
        const rollDiceBtn = document.getElementById('roll-dice');
        const endTurnBtn = document.getElementById('end-turn');
        const gameLogEl = document.getElementById('game-log');
        const actionModal = document.getElementById('action-modal');
        const diceModal = document.getElementById('dice-modal');
        const modalTitle = document.getElementById('modal-title');
        const modalMessage = document.getElementById('modal-message');
        const modalActions = document.getElementById('modal-actions');
        const closeModalBtn = document.getElementById('close-modal');
        const diceResult = document.getElementById('dice-result');
        const diceTotal = document.getElementById('dice-total');
        const diceDisplay = document.getElementById('dice-display');
        const diceTotalDisplay = document.getElementById('dice-total-display');
        
        // Initialize game
        function initGame() {
            updatePlayerInfo();
            positionTokens();
            updateHealthBars();
            
            // Event listeners
            rollDiceBtn.addEventListener('click', rollDice);
            endTurnBtn.addEventListener('click', endTurn);
            closeModalBtn.addEventListener('click', closeModal);
            
            addToGameLog("Jogo iniciado! O primeiro jogador é " + gameState.players[0].name);
        }
        
        // Update player info display
        function updatePlayerInfo() {
            const currentPlayer = gameState.players[gameState.currentPlayerIndex];
            currentPlayerEl.textContent = currentPlayer.name;
            currentPlayerEl.className = font-bold text-${currentPlayer.color}-600;
            currentBalanceEl.textContent = currentPlayer.balance;
            
            // Update all player balances
            gameState.players.forEach(player => {
                document.getElementById(balance-${player.id}).textContent = player.balance;
            });
            
            updateHealthBars();
        }
        
        // Update health bars based on player balance
        function updateHealthBars() {
            gameState.players.forEach(player => {
                const healthBar = document.getElementById(health-${player.id});
                const percentage = Math.min(100, (player.balance / 1500) * 100);
                healthBar.style.width = ${percentage}%;
            });
        }
        
        // Position player tokens on the board
        function positionTokens() {
            gameState.players.forEach(player => {
                const token = document.getElementById(token-${player.id});
                const position = player.position;
                
                // Calculate position on board (simplified for this example)
                // In a real implementation, you'd need more complex logic to position tokens
                // based on the actual board layout
                let row, col;
                
                if (position <= 8) {
                    // Top row
                    row = 1;
                    col = position + 2;
                } else if (position <= 16) {
                    // Right column
                    row = position - 7;
                    col = 11;
                } else if (position <= 24) {
                    // Bottom row
                    row = 11;
                    col = 26 - position;
                } else {
                    // Left column
                    row = 33 - position;
                    col = 1;
                }
                
                token.style.gridRow = row;
                token.style.gridColumn = col;
            });
        }
        
        // Roll dice
        function rollDice() {
            if (gameState.diceRolled) {
                showModal("Ação inválida", "Você já lançou os dados neste turno.");
                return;
            }
            
            // Show rolling animation
            diceModal.style.display = "block";
            diceResult.innerHTML = '<i class="fas fa-dice fa-spin text-5xl"></i><i class="fas fa-dice fa-spin text-5xl"></i>';
            diceTotal.textContent = "";
            
            // Simulate dice roll with delay
            setTimeout(() => {
                const die1 = Math.floor(Math.random() * 6) + 1;
                const die2 = Math.floor(Math.random() * 6) + 1;
                const total = die1 + die2;
                
                diceResult.innerHTML = <i class="fas fa-dice-${die1} text-5xl"></i> <i class="fas fa-dice-${die2} text-5xl"></i>;
                diceTotal.textContent = Total: ${total};
                
                // Update center dice display
                diceDisplay.innerHTML = <i class="fas fa-dice-${die1}"></i><i class="fas fa-dice-${die2}"></i>;
                diceTotalDisplay.textContent = total;
                
                // Close dice modal after a delay
                setTimeout(() => {
                    diceModal.style.display = "none";
                    movePlayer(total);
                }, 1500);
                
                gameState.diceRolled = true;
                endTurnBtn.disabled = false;
                
                addToGameLog(${gameState.players[gameState.currentPlayerIndex].name} lançou os dados e obteve ${total}.);
            }, 1000);
        }
        
        // Move player
        function movePlayer(spaces) {
            const player = gameState.players[gameState.currentPlayerIndex];
            player.position = (player.position + spaces) % 32;
            
            // Check if passed start
            if (player.position < spaces) {
                player.balance += 200;
                addToGameLog(${player.name} passou pela partida e recebeu $200.);
                updatePlayerInfo();
            }
            
            positionTokens();
            checkLandingPosition();
        }
        
        // Check what happens when player lands on a position
        function checkLandingPosition() {
            const player = gameState.players[gameState.currentPlayerIndex];
            const property = gameState.properties[player.position];
            
            switch (property.type) {
                case "start":
                    // Nothing happens
                    break;
                case "jail":
                    // Just visiting
                    showModal("Prisão", "Você está apenas visitando a prisão.");
                    break;
                case "free":
                    // Free parking
                    showModal("Parada Livre", "Aproveite para descansar!");
                    break;
                case "tax":
                    // Pay tax
                    payTax(property.amount);
                    break;
                case "chance":
                    // Chance card
                    drawChanceCard();
                    break;
                default:
                    // Property
                    if (property.owner === null) {
                        // Unowned property - offer to buy
                        offerPurchase(property);
                    } else if (property.owner !== player.id) {
                        // Owned by another player - pay rent
                        payRent(property);
                    } else {
                        // Owned by current player
                        showModal("Propriedade", Você já é dono de ${property.name}.);
                    }
            }
        }
        
        // Offer property purchase
        function offerPurchase(property) {
            const player = gameState.players[gameState.currentPlayerIndex];
            
            if (player.balance >= property.price) {
                modalTitle.textContent = "Comprar Propriedade";
                modalMessage.textContent = Deseja comprar ${property.name} por $${property.price}?;
                
                modalActions.innerHTML = `
                    <button class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg" id="buy-property">
                        <i class="fas fa-check mr-2"></i>Comprar
                    </button>
                    <button class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg" id="decline-property">
                        <i class="fas fa-times mr-2"></i>Recusar
                    </button>
                `;
                
                document.getElementById('buy-property').addEventListener('click', () => {
                    buyProperty(property);
                    closeModal();
                });
                
                document.getElementById('decline-property').addEventListener('click', () => {
                    addToGameLog(${player.name} recusou comprar ${property.name}.);
                    closeModal();
                });
                
                actionModal.style.display = "block";
            } else {
                showModal("Sem dinheiro", Você não tem dinheiro suficiente para comprar ${property.name}.);
            }
        }
        
        // Buy property
        function buyProperty(property) {
            const player = gameState.players[gameState.currentPlayerIndex];
            
            player.balance -= property.price;
            property.owner = player.id;
            player.properties.push(property.id);
            
            updatePlayerInfo();
            addToGameLog(${player.name} comprou ${property.name} por $${property.price}.);
            
            // Update property display (in a real game, you'd show ownership visually)
        }
        
        // Pay rent
        function payRent(property) {
            const player = gameState.players[gameState.currentPlayerIndex];
            const owner = gameState.players.find(p => p.id === property.owner);
            
            let rentAmount;
            
            if (property.group === "railroad") {
                // Rent for railroads depends on number owned
                const ownedRailroads = owner.properties.filter(propId => 
                    gameState.properties[propId].group === "railroad").length;
                rentAmount = property.rent[ownedRailroads - 1];
            } else if (property.group === "utility") {
                // Utility rent depends on dice roll (simplified here)
                const diceRoll = Math.floor(Math.random() * 6) + 1 + Math.floor(Math.random() * 6) + 1;
                const ownedUtilities = owner.properties.filter(propId => 
                    gameState.properties[propId].group === "utility").length;
                rentAmount = diceRoll * property.rent[ownedUtilities - 1];
            } else {
                // Regular property rent
                rentAmount = property.houses === 0 ? property.rent[0] : 
                             property.houses === 5 ? property.rent[5] : // Hotel
                             property.rent[property.houses];
            }
            
            player.balance -= rentAmount;
            owner.balance += rentAmount;
            
            updatePlayerInfo();
            addToGameLog(${player.name} pagou $${rentAmount} de aluguel para ${owner.name} por ${property.name}.);
            
            showModal("Pagamento de Aluguel", Você pagou $${rentAmount} de aluguel para ${owner.name}.);
            
            // Check if player is bankrupt
            if (player.balance < 0) {
                handleBankruptcy(player, owner);
            }
        }
        
        // Pay tax
        function payTax(amount) {
            const player = gameState.players[gameState.currentPlayerIndex];
            
            player.balance -= amount;
            updatePlayerInfo();
            addToGameLog(${player.name} pagou $${amount} de imposto.);
            
            showModal("Imposto", Você pagou $${amount} de imposto.);
            
            // Check if player is bankrupt
            if (player.balance < 0) {
                handleBankruptcy(player, null);
            }
        }
        
        // Draw chance card
        function drawChanceCard() {
            const cards = [
                "Avance até a Partida e receba $200.",
                "Você ganhou um concurso de beleza! Receba $100.",
                "Pague $50 para cada jogador.",
                "Você foi eleito presidente do conselho. Pague $50 para cada jogador.",
                "Sua construção e empréstimo maturam. Receba $150.",
                "Vá para a prisão. Não passe pela partida.",
                "Receba $20 de cada jogador.",
                "Pague $100 de impostos.",
                "Avance até a Av. Paulista.",
                "Avance até a Av. Vieira Souto."
            ];
            
            const card = cards[Math.floor(Math.random() * cards.length)];
            showModal("Sorte/Reves", card);
            addToGameLog(${gameState.players[gameState.currentPlayerIndex].name} tirou a carta: ${card});
            
            // In a full implementation, you'd need to handle the card effects
        }
        
        // Handle bankruptcy
        function handleBankruptcy(player, creditor) {
            showModal("Falência", ${player.name} faliu!);
            addToGameLog(${player.name} faliu e está fora do jogo!);
            
            // Transfer properties to creditor (if any)
            if (creditor) {
                player.properties.forEach(propId => {
                    const prop = gameState.properties[propId];
                    prop.owner = creditor.id;
                    creditor.properties.push(propId);
                });
                
                addToGameLog(Todas as propriedades de ${player.name} foram transferidas para ${creditor.name}.);
            }
            
            // Remove player from game
            gameState.players = gameState.players.filter(p => p.id !== player.id);
            
            // Check if game is over
            if (gameState.players.length === 1) {
                endGame(gameState.players[0]);
                return;
            }
            
            // Adjust current player index if needed
            if (gameState.currentPlayerIndex >= gameState.players.length) {
                gameState.currentPlayerIndex = 0;
            }
            
            endTurn();
        }
        
        // End game
        function endGame(winner) {
            showModal("Fim de Jogo", ${winner.name} venceu o jogo! Parabéns!);
            addToGameLog(FIM DE JOGO! ${winner.name} é o vencedor!);
            
            rollDiceBtn.disabled = true;
            endTurnBtn.disabled = true;
        }
        
        // End turn
        function endTurn() {
            gameState.diceRolled = false;
            gameState.currentPlayerIndex = (gameState.currentPlayerIndex + 1) % gameState.players.length;
            endTurnBtn.disabled = true;
            
            updatePlayerInfo();
            addToGameLog(Turno de ${gameState.players[gameState.currentPlayerIndex].name}.);
        }
        
        // Show modal
        function showModal(title, message) {
            modalTitle.textContent = title;
            modalMessage.textContent = message;
            modalActions.innerHTML = "";
            
            const okBtn = document.createElement("button");
            okBtn.className = "bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg";
            okBtn.innerHTML = '<i class="fas fa-check mr-2"></i>OK';
            okBtn.addEventListener('click', closeModal);
            
            modalActions.appendChild(okBtn);
            actionModal.style.display = "block";
        }
        
        // Close modal
        function closeModal() {
            actionModal.style.display = "none";
            diceModal.style.display = "none";
        }
        
        // Add message to game log
        function addToGameLog(message) {
            const logEntry = document.createElement("div");
            logEntry.className = "mb-1";
            logEntry.textContent = message;
            gameLogEl.appendChild(logEntry);
            gameLogEl.scrollTop = gameLogEl.scrollHeight;
        }
        
        // Start the game
        initGame();
    </script>
</body>
</html>